# Security Policy

## 支持的版本

当前支持安全更新的版本：

| 版本 | 支持状态 |
| ------- | ------------------ |
| 0.1.x   | :white_check_mark: |

## 报告安全漏洞

我们非常重视安全问题。如果你发现了安全漏洞，请**不要**公开提交 Issue。

### 报告流程

1. **发送邮件**
   - 邮箱: security@emailhub.com
   - 主题: [Security] 简短描述

2. **包含信息**
   - 漏洞描述
   - 影响范围
   - 复现步骤
   - 可能的修复方案（可选）
   - 你的联系方式

3. **响应时间**
   - 我们会在 48 小时内确认收到
   - 7 天内提供初步评估
   - 30 天内发布修复版本（视严重程度）

### 安全最佳实践

#### 1. 环境变量保护

```bash
# 不要将敏感信息提交到 Git
.env
.env.local
.env.production

# 使用强密钥
NEXTAUTH_SECRET=$(openssl rand -base64 32)
ENCRYPTION_KEY=$(openssl rand -hex 16)
```

#### 2. 数据库安全

```bash
# 使用强密码
DATABASE_URL="postgresql://user:STRONG_PASSWORD@localhost:5432/db"

# 限制数据库访问
# 只允许应用服务器 IP 访问
```

#### 3. 邮箱密码

```bash
# 使用应用专用密码，不要使用账户主密码
# Gmail: 生成应用专用密码
# QQ/163: 使用授权码
```

#### 4. API 安全

```bash
# 启用 HTTPS
# 使用 CORS 限制
# 实施速率限制
# 验证所有输入
```

#### 5. 推送渠道

```bash
# 保护 Webhook URL
# 不要在公开代码中暴露
# 定期轮换密钥
```

### 已知安全考虑

#### 1. 密码存储
- ✅ 邮箱密码使用 AES-256 加密
- ✅ 用户密码使用 bcrypt 哈希
- ✅ 加密密钥存储在环境变量

#### 2. 数据传输
- ✅ IMAP/SMTP 使用 TLS 加密
- ✅ API 通信使用 HTTPS
- ✅ Webhook 推送使用 HTTPS

#### 3. 访问控制
- ✅ 用户认证和会话管理
- ✅ 数据隔离（用户只能访问自己的数据）
- ⚠️ 暂不支持双因素认证（计划中）

#### 4. 输入验证
- ✅ 使用 Zod 进行数据验证
- ✅ SQL 注入防护（Prisma ORM）
- ✅ XSS 防护（React 自动转义）

#### 5. 依赖安全
- ✅ 定期更新依赖
- ✅ 使用 npm audit 检查漏洞
- ✅ 锁定依赖版本（package-lock.json）

### 安全检查清单

部署前请确保：

- [ ] 更改所有默认密码和密钥
- [ ] 启用 HTTPS
- [ ] 配置防火墙规则
- [ ] 限制数据库访问
- [ ] 启用日志记录
- [ ] 设置备份策略
- [ ] 配置监控告警
- [ ] 审查环境变量
- [ ] 更新所有依赖
- [ ] 运行安全扫描

### 安全更新

我们会在以下情况发布安全更新：

1. **严重漏洞** - 立即发布补丁
2. **高危漏洞** - 7 天内发布补丁
3. **中危漏洞** - 30 天内发布补丁
4. **低危漏洞** - 下一个版本修复

### 安全公告

安全更新会通过以下渠道发布：

- GitHub Security Advisories
- Release Notes
- 邮件通知（注册用户）

### 负责任的披露

我们承诺：

1. **及时响应** - 48 小时内确认
2. **保密处理** - 修复前不公开
3. **致谢贡献** - 在修复公告中致谢（如果你同意）
4. **持续改进** - 从漏洞中学习，改进安全措施

### 联系方式

- **安全邮箱**: security@emailhub.com
- **PGP 密钥**: [公钥链接]
- **响应时间**: 工作日 48 小时内

---

感谢你帮助我们保持 EmailHub 的安全！🔒
